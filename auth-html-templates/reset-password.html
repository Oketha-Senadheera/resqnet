<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Reset Password • resqnet</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles/app.css" />
    <script src="scripts/vendor/lucide.js"></script>
  </head>
  <body class="u-bg-surface">
    <button
      type="button"
      class="c-theme-toggle js-theme-toggle"
      aria-pressed="false"
      aria-label="Toggle dark mode"
    >
      <span class="c-theme-toggle__icon" aria-hidden="true"><i data-lucide="moon"></i></span>
      <span class="c-theme-toggle__label">Dark</span>
    </button>
    <main class="o-center">
      <section class="c-auth" aria-labelledby="rp-title">
        <h1 class="c-auth__title" id="rp-title">Set a new password</h1>
        <p
          class="u-text-muted"
          style="
            margin-top: -0.75rem;
            margin-bottom: var(--space-8);
            font-size: var(--fs-sm);
          "
        >
          Your new password must be at least 8 characters and include a mix of
          upper & lower case letters, numbers, and symbols.
        </p>
        <form class="c-auth__form js-reset-form js-validate" novalidate>
          <!-- Hidden reset token placeholder (replace value dynamically server-side) -->
          <input type="hidden" name="token" value="{{RESET_TOKEN}}" />
          <div class="c-field">
            <label for="newPassword" class="c-field__label">New Password</label>
            <input
              type="password"
              id="newPassword"
              name="password"
              class="c-field__input js-password"
              placeholder="Enter a new password"
              required
              minlength="8"
              autocomplete="new-password"
            />
            <p
              class="c-field__error"
              data-error-for="newPassword"
              aria-live="polite"
            ></p>
          </div>
          <div
            class="c-password-meter"
            id="resetPasswordStrength"
            data-strength="0"
            aria-live="polite"
            aria-label="Password strength"
          >
            <div class="c-password-meter__bar" aria-hidden="true"></div>
            <p class="c-password-meter__label js-password-strength-label">
              Very weak
            </p>
          </div>
          <div class="c-field">
            <label for="confirmNewPassword" class="c-field__label"
              >Confirm Password</label
            >
            <input
              type="password"
              id="confirmNewPassword"
              name="confirmPassword"
              class="c-field__input"
              placeholder="Re-enter your new password"
              required
              minlength="8"
              autocomplete="new-password"
            />
            <p
              class="c-field__error"
              data-error-for="confirmNewPassword"
              aria-live="polite"
            ></p>
          </div>
          <button type="submit" class="c-btn c-btn--primary c-auth__submit">
            Update Password
          </button>
        </form>
        <div class="c-auth__switch">
          Back to <a class="c-link" href="index.html">Login</a>
        </div>
        <footer class="c-auth__legal">
          <a href="#" class="c-link c-link--muted">Terms of Service</a>
          <span aria-hidden="true">·</span>
          <a href="#" class="c-link c-link--muted">Privacy Policy</a>
        </footer>
      </section>
    </main>
    <script src="scripts/app.js"></script>
    <script>
      // Init password strength meter
      resqnet.password.initPasswordMeter(
        "#newPassword",
        "#resetPasswordStrength"
      );
      const form = document.querySelector(".js-reset-form");
      form?.addEventListener("submit", (e) => {
        const pw = document.getElementById("newPassword");
        const cpw = document.getElementById("confirmNewPassword");
        if (pw && cpw && pw.value !== cpw.value) {
          e.preventDefault();
          const field = cpw.closest(".c-field");
          if (field) {
            field.classList.add("is-invalid");
            const err = field.querySelector(".c-field__error");
            if (err) err.textContent = "Passwords do not match";
          }
        }
      });
    </script>
  </body>
</html>
